<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng"><head>
<meta http-equiv="X-UA-Compatible" content="IE=7"/>
<title>History of the Ring Design</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/><link rel="home" href="index.html" title="OpenStack Object Storage Administrator Manual"/><link rel="up" href="working-with-rings.html" title="Working with Rings"/><link rel="prev" href="building-the-ring.html" title="Building the Ring"/><link rel="next" href="the-account-reaper.html" title="The Account Reaper"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "treeview-3865";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Your browser is not supported. Use of Mozilla Firefox is recommended.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
        </script><style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
            
        </style><link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/><link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/><!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
	<![endif]--><link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/><link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/><script type="text/javascript" src="../common/jquery/jquery-1.4.2.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script><script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script><script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script><script type="text/javascript" src="search/nwSearchFnt.js"><!----></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"><!--//make this scalable to other languages as well.--></script><script type="text/javascript" src="search/index-1.js"><!----></script><script type="text/javascript" src="search/index-2.js"><!----></script><script type="text/javascript" src="search/index-3.js"><!----></script><script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-6']);
	  </script><script type="text/javascript" src="../common/ga.js"><!----></script></head><body><div id="header"><a onclick="_gaq.push(['_trackEvent', 'Header', 'logo', 'click', 1]);" target="_blank" href="http://www.openstack.org"><img src="../common/images/openstack-logo.png" alt="OpenStack Documentation" width="157" height="47"/></a><p class="breadcrumbs"><a href="http://docs.openstack.org/">OpenStack Manuals</a><a href="index.html">OpenStack Object Storage Administrator Manual
   - 1.4.3</a></p><h1>History of the Ring Design</h1><div id="navheader" align="right"><!----><table class="navLinks"><tr><td><a id="showHideButton" onclick="showHideToc(); _gaq.push(['_trackEvent', 'Header', 'show/hide', 'click', 1]);" class="pointLeft" title="Hide TOC tree">Sidebar
                            </a></td><td><a accesskey="p" class="navLinkPrevious" onclick="_gaq.push(['_trackEvent', 'Header', 'prevLink', 'click', 1]);" tabindex="5" href="building-the-ring.html">Prev</a>
				      |
                                        <a accesskey="u" class="navLinkUp" onclick="_gaq.push(['_trackEvent', 'Header', 'upLink', 'click', 1]);" tabindex="5" href="working-with-rings.html">Up</a>
				  |
                                    <a accesskey="n" class="navLinkNext" onclick="_gaq.push(['_trackEvent', 'Header', 'nextLink', 'click', 1]);" tabindex="5" href="the-account-reaper.html">Next</a></td></tr></table></div></div><div id="content"><div class="statustext"> </div><div class="section" title="History of the Ring Design"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="history-of-the-ring-design"/>History of the Ring Design</h4></div></div></div><p>The ring code went through many iterations before arriving at what it is now
                and while it has been stable for a while now, the algorithm may be tweaked or
                perhaps even fundamentally changed if new ideas emerge. This section will try
                to describe the previous ideas attempted and attempt to explain why they were
                discarded.</p><p>A “live ring” option was considered where each server could maintain its own
                copy of the ring and the servers would use a gossip protocol to communicate the
                changes they made. This was discarded as too complex and error prone to code
                correctly in the project time span available. One bug could easily gossip bad
                data out to the entire cluster and be difficult to recover from. Having an
                externally managed ring simplifies the process, allows full validation of data
                before it's shipped out to the servers, and guarantees each server is using a
                ring from the same timeline. It also means that the servers themselves aren't
                spending a lot of resources maintaining rings.</p><p>A couple of “ring server” options were considered. One was where all ring
                lookups would be done by calling a service on a separate server or set of
                servers, but this was discarded due to the latency involved. Another was much
                like the current process but where servers could submit change requests to the
                ring server to have a new ring built and shipped back out to the servers. This
                was discarded due to project time constraints and because ring changes are
                currently infrequent enough that manual control was sufficient. However, lack
                of quick automatic ring changes did mean that other parts of the system had to
                be coded to handle devices being unavailable for a period of hours until
                someone could manually update the ring.</p><p>The current ring process has each replica of a partition independently assigned
                to a device. A version of the ring that used a third of the memory was tried,
                where the first replica of a partition was directly assigned and the other two
                were determined by “walking” the ring until finding additional devices in other
                zones. This was discarded as control was lost as to how many replicas for a
                given partition moved at once. Keeping each replica independent allows for
                moving only one partition replica within a given time window (except due to
                device failures). Using the additional memory was deemed a good tradeoff for
                moving data around the cluster much less often.</p><p>Another ring design was tried where the partition to device assignments weren't
                stored in a big list in memory but instead each device was assigned a set of
                hashes, or anchors. The partition would be determined from the data item's hash
                and the nearest device anchors would determine where the replicas should be
                stored. However, to get reasonable distribution of data each device had to have
                a lot of anchors and walking through those anchors to find replicas started to
                add up. In the end, the memory savings wasn't that great and more processing
                power was used, so the idea was discarded.</p><p>A completely non-partitioned ring was also tried but discarded as the
                partitioning helps many other parts of the system, especially replication.
                Replication can be attempted and retried in a partition batch with the other
                replicas rather than each data item independently attempted and retried. Hashes
                of directory structures can be calculated and compared with other replicas to
                reduce directory walking and network traffic.</p><p>Partitioning and independently assigning partition replicas also allowed for
                the best balanced cluster. The best of the other strategies tended to give
                +-10% variance on device balance with devices of equal weight and +-15% with
                devices of varying weights. The current strategy allows us to get +-3% and +-8%
                respectively.</p><p>Various hashing algorithms were tried. SHA offers better security, but the ring
                doesn't need to be cryptographically secure and SHA is slower. Murmur was much
                faster, but MD5 was built-in and hash computation is a small percentage of the
                overall request handling time. In all, once it was decided the servers wouldn't
                be maintaining the rings themselves anyway and only doing hash lookups, MD5 was
                chosen for its general availability, good distribution, and adequate speed.</p></div><script type="text/javascript" src="../common/main.js"><!----></script><hr/><div id="disqus_thread"><script type="text/javascript">
	      var disqus_shortname = 'openstackdocs'; 	      
	    </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><script type="text/javascript" src="../common/comments.js"><!----></script></div><hr/><div class="legal"><a href="index.html">Legal notices</a></div></div><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div id="tabs"><ul><li><a href="#treeDiv" tabindex="1"><span class="contentsTab">Contents</span></a></li><li><a href="#searchDiv" tabindex="1"><span class="searchTab">Search</span></a></li></ul><div id="treeDiv"><img src="../common/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"/><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li tabindex="2"><span class="file"><a href="ch_getting-started-with-openstack.html">1. Getting Started with OpenStack</a></span><ul><li tabindex="2"><span class="file"><a href="what-is-openstack.html">What is OpenStack?</a></span></li><li tabindex="2"><span class="file"><a href="components-of-openstack.html">Components of OpenStack</a></span></li><li tabindex="2"><span class="file"><a href="openstack-architecture-overview.html">OpenStack Project Architecture Overview</a></span><ul><li tabindex="2"><span class="file"><a href="cloud-provider-conceptual-architecture.html">Cloud Provider Conceptual Architecture</a></span></li><li tabindex="2"><span class="file"><a href="openstack-nova-logical-architecture.html">OpenStack Compute Logical Architecture</a></span></li><li tabindex="2"><span class="file"><a href="nova-conceptual-mapping.html">Nova Conceptual Mapping</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="why-cloud.html">Why Cloud?</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="ch_introduction-to-openstack-object-storage.html">2. Introduction to OpenStack Object Storage</a></span><ul><li tabindex="2"><span class="file"><a href="accounts-and-account-servers.html">Accounts and Account Servers</a></span></li><li tabindex="2"><span class="file"><a href="authentication-and-access-permissions.html">Authentication and Access Permissions</a></span></li><li tabindex="2"><span class="file"><a href="containers-and-objects.html">Containers and Objects</a></span></li><li tabindex="2"><span class="file"><a href="operations.html">Operations</a></span></li><li tabindex="2"><span class="file"><a href="language-specific-api-bindings.html">Language-Specific API Bindings</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="ch_installing-and-configuring-openstack-object-storage.html">3. Installing and Configuring OpenStack Object Storage</a></span><ul><li tabindex="2"><span class="file"><a href="object-storage-system-requirements.html">System Requirements</a></span></li><li tabindex="2"><span class="file"><a href="installing-openstack-object-storage-on-ubuntu.html">Installing OpenStack Object Storage on Ubuntu</a></span><ul><li tabindex="2"><span class="file"><a href="before-you-begin-swift-install.html">Before You Begin</a></span></li><li tabindex="2"><span class="file"><a href="example-installation-architecture-swift.html">Example Installation Architecture</a></span></li><li tabindex="2"><span class="file"><a href="network-setup-notes.html">Network Setup Notes</a></span></li><li tabindex="2"><span class="file"><a href="general-installation-steps-swift.html">General Installation Steps </a></span></li></ul></li><li tabindex="2"><span class="file"><a href="configuring-openstack-object-storage.html">Configuring OpenStack Object Storage </a></span><ul><li tabindex="2"><span class="file"><a href="installing-and-configuring-auth-node.html">Installing and Configuring an Auth Node</a></span></li><li tabindex="2"><span class="file"><a href="installing-and-configuring-the-proxy-node.html">Installing and Configuring the Proxy Node</a></span></li><li tabindex="2"><span class="file"><a href="installing-and-configuring-storage-nodes.html">Installing and Configuring the Storage Nodes</a></span><ul><li tabindex="2"><span class="file"><a href="verify-swift-installation.html">Create OpenStack Object Storage admin Account and Verify the Installation</a></span></li><li tabindex="2"><span class="file"><a href="adding-a-proxy-server.html">Adding an Additional Proxy Server</a></span></li><li tabindex="2"><span class="file"><a href="troubleshooting-notes.html">Troubleshooting Notes</a></span></li></ul></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="ch_running-openstack-object-storage.html">4. System Administration for OpenStack Object Storage</a></span><ul><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html">Understanding How Object Storage Works</a></span><ul><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#the-ring">The Ring</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#d6e549">Proxy Server</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#object-server">Object Server</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#container-server">Container Server</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#d6e562">Account Server</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#swift-replication">Replication</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#updaters">Updaters</a></span></li><li tabindex="2"><span class="file"><a href="understanding-how-object-storage-works.html#auditors">Auditors</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="configuring-and-tuning-openstack-object-storage.html">Configuring and Tuning OpenStack Object Storage</a></span></li><li tabindex="2"><span class="file"><a href="preparing-the-ring.html">Preparing the Ring</a></span></li><li tabindex="2"><span class="file"><a href="server-configuration-reference.html">Server Configuration Reference</a></span><ul><li tabindex="2"><span class="file"><a href="object-server-configuration.html">Object Server Configuration</a></span></li><li tabindex="2"><span class="file"><a href="container-server-configuration.html">Container Server Configuration</a></span></li><li tabindex="2"><span class="file"><a href="account-server-configuration.html">Account Server Configuration</a></span></li><li tabindex="2"><span class="file"><a href="proxy-server-configuration.html">Proxy Server Configuration</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="considerations-and-tuning.html">Considerations and Tuning</a></span><ul><li tabindex="2"><span class="file"><a href="memcached-considerations.html">Memcached Considerations</a></span></li><li tabindex="2"><span class="file"><a href="system-time.html">System Time</a></span></li><li tabindex="2"><span class="file"><a href="general-service-tuning.html">General Service Tuning</a></span></li><li tabindex="2"><span class="file"><a href="filesystem-considerations.html">Filesystem Considerations</a></span></li><li tabindex="2"><span class="file"><a href="general-system-tuning.html">General System Tuning</a></span></li><li tabindex="2"><span class="file"><a href="logging-considerations.html">Logging Considerations</a></span></li><li tabindex="2"><span class="file"><a href="working-with-rings.html">Working with Rings</a></span><ul><li tabindex="2"><span class="file"><a href="managing-rings-with-the-ring-builder.html">Managing Rings with the Ring Builder</a></span><ul><li tabindex="2"><span class="file"><a href="about-the-ring-data-structure.html">About the Ring Data Structure</a></span><ul><li tabindex="2"><span class="file"><a href="list-of-devices-in-the-ring.html">List of Devices in the Ring</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="partition-assignment-list.html">Partition Assignment List</a></span></li><li tabindex="2"><span class="file"><a href="partition-shift-value.html">Partition Shift Value</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="building-the-ring.html">Building the Ring</a></span></li><li tabindex="2" id="webhelp-currentid"><span class="file"><a href="history-of-the-ring-design.html">History of the Ring Design</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="the-account-reaper.html">The Account Reaper</a></span><ul><li tabindex="2"><span class="file"><a href="account-reaper-background-and-history.html">Account Reaper Background and History</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="replication.html">Replication</a></span><ul><li tabindex="2"><span class="file"><a href="database-replication.html">Database Replication</a></span></li><li tabindex="2"><span class="file"><a href="object-replication.html">Object Replication</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="managing-large-objects.html">Managing Large Objects (Greater than 5 GB)</a></span><ul><li tabindex="2"><span class="file"><a href="using-swift-to-manage-segmented-objects.html">Using swift to Manage Segmented Objects</a></span></li><li tabindex="2"><span class="file"><a href="direct-api-management-of-large-objects.html">Direct API Management of Large Objects</a></span></li><li tabindex="2"><span class="file"><a href="additional-notes-on-large-objects.html">Additional Notes on Large Objects</a></span></li><li tabindex="2"><span class="file"><a href="large-object-storage-history-and-background.html">Large Object Storage History and Background</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="throttling-resources-by-setting-rate-limits.html">Throttling Resources by Setting Rate Limits</a></span><ul><li tabindex="2"><span class="file"><a href="configuration-for-rate-limiting.html">Configuration for Rate Limiting</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="configuring-openstack-object-storage-with-s3_api.html">Configuring Object Storage with the S3 API</a></span></li><li tabindex="2"><span class="file"><a href="managing-openstack-object-storage-with-swift-cli.html">Managing OpenStack Object Storage with CLI Swift</a></span><ul><li tabindex="2"><span class="file"><a href="swift-cli-basics.html">Swift CLI Basics</a></span><ul><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1623">stat [container] [object]</a></span></li><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1626">list [options] [container]</a></span></li><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1629">upload [options] container file_or_directory [file_or_directory] […]</a></span></li><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1632">post [options] [container] [object]</a></span></li><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1636">download —all OR download container [object] [object] …</a></span></li><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1639">delete —all OR delete container [object] [object] …</a></span></li><li tabindex="2"><span class="file"><a href="swift-cli-basics.html#d6e1643">Options for swift</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="analyzing-log-files-with-swift-cli.html">Analyzing Log Files with Swift CLI</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="ch_openstack-object-storage-tutorials.html">5. OpenStack Object Storage Tutorials</a></span><ul><li tabindex="2"><span class="file"><a href="storing-large-photos-or-videos-on-the-cloud.html">Storing Large Photos or Videos on the Cloud</a></span><ul><li tabindex="2"><span class="file"><a href="part-i-setting-up-secure-access.html">Part I: Setting Up Secure Access</a></span></li><li tabindex="2"><span class="file"><a href="part-ii-configuring-cyberduck.html">Part II: Configuring Cyberduck</a></span></li><li tabindex="2"><span class="file"><a href="part-iii-copying-files.html">Part III: Creating Containers (Folders) and Uploading Files</a></span></li></ul></li></ul></li><li tabindex="2"><span class="file"><a href="ch_support-and-troubleshooting.html">6. Support and Troubleshooting</a></span><ul><li tabindex="2"><span class="file"><a href="community-support.html">Community Support</a></span><ul><li tabindex="2"><span class="file"><a href="community-support.html#d6e1732">The Launchpad Answers area</a></span></li><li tabindex="2"><span class="file"><a href="community-support.html#d6e1737">OpenStack mailing list</a></span></li><li tabindex="2"><span class="file"><a href="community-support.html#d6e1742">The OpenStack Wiki search </a></span></li><li tabindex="2"><span class="file"><a href="community-support.html#d6e1746">The Launchpad Bugs area </a></span></li><li tabindex="2"><span class="file"><a href="community-support.html#d6e1762">The OpenStack IRC channel </a></span></li></ul></li><li tabindex="2"><span class="file"><a href="troubleshooting-openstack-object-storage.html">Troubleshooting OpenStack Object Storage</a></span><ul><li tabindex="2"><span class="file"><a href="handling-drive-failure.html">Handling Drive Failure</a></span></li><li tabindex="2"><span class="file"><a href="handling-server-failure.html">Handling Server Failure</a></span></li><li tabindex="2"><span class="file"><a href="detecting-failed-drives.html">Detecting Failed Drives</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="troubleshooting-openstack-compute.html">Troubleshooting OpenStack Compute</a></span><ul><li tabindex="2"><span class="file"><a href="log-files-for-openstack-compute.html">Log files for OpenStack Compute</a></span></li><li tabindex="2"><span class="file"><a href="common-errors-and-fixes-for-openstack-compute.html">Common Errors and Fixes for OpenStack Compute</a></span></li></ul></li></ul></li></ul></div></div><div id="searchDiv"><div id="search"><form onsubmit="Verifie(ditaSearch_Form);return false" name="ditaSearch_Form" class="searchForm"><fieldset class="searchFieldSet"><legend>Search</legend><center><input id="textToSearch" name="textToSearch" type="text" class="searchText"/> &nbsp; <input onclick="Verifie(ditaSearch_Form)" type="button" class="searchButton" value="Go" id="doSearch"/></center></fieldset></form></div><div id="searchResults"><center/></div><p class="searchHighlight"><a href="#" onclick="toggleHighlight()">Search Highlighter (On/Off)</a></p></div></div></div></div></body></html>